{% extends "base.html" %}

{% block title %}
  {{ taxonomy.name | title }} | Cosme
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{{ get_url(path="readings-list.css") | safe }}">
{% endblock %}

{% block content %}
  <div class="readings-list">
    <a href="/blog" class="back-link">← Back to all posts</a>
    <h1 class="readings-list-title">Readings</h1>
    <p class="readings-description">A collection of books I've read and my thoughts on them.</p>
    
    <div class="readings-grid">
      {% for term in terms %}
        {% if term.pages and term.pages | length > 0 %}
          {% set latest_page = term.pages | sort(attribute="date") | last %}
          {% if latest_page.extra and latest_page.extra.has_single_page is defined and latest_page.extra.has_single_page == false %}
            <div class="reading-card">
          {% else %}
            <div class="reading-card" onclick="window.location='{{ term.permalink }}';">
          {% endif %}
            {% if latest_page.extra and latest_page.extra.cover_image %}
              <div class="reading-card-cover">
                <img src="{{ latest_page.extra.cover_image }}" alt="Cover of {{ latest_page.title }}">
              </div>
            {% endif %}
            
            <div class="reading-card-overlay">
              <div class="reading-card-content">
                <h3 class="reading-title">
                  {{ latest_page.title }}
                </h3>
                
                {% if latest_page.extra and latest_page.extra.author %}
                  <p class="reading-author">by {{ latest_page.extra.author }}</p>
                {% endif %}
                
                {% if latest_page.description %}
                  <p class="reading-description">{{ latest_page.description }}</p>
                {% endif %}
                
                <div class="reading-meta">
                  {% if latest_page.extra and latest_page.extra.rating %}
                    <div class="reading-rating">
                      {% for i in range(end=latest_page.extra.rating) %}
                        <span class="star">⭐</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                  
                  {% if latest_page.taxonomies and latest_page.taxonomies.readings %}
                    <div class="reading-categories">
                      {% for category in latest_page.taxonomies.readings %}
                        <span class="reading-category">{{ category | slugify | replace(from="-", to=" ") | title }}</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                  
                  {% if latest_page.extra and latest_page.extra.has_single_page is defined and latest_page.extra.has_single_page == false %}
                    {% if latest_page.extra.key_insights %}
                      <div class="reading-insights">
                        <h4>Key Insights</h4>
                        <ul>
                          {% for insight in latest_page.extra.key_insights %}
                            <li>{{ insight }}</li>
                          {% endfor %}
                        </ul>
                      </div>
                    {% endif %}
                    
                    {% if latest_page.extra.personal_note %}
                      <div class="reading-personal-note">
                        <p>{{ latest_page.extra.personal_note }}</p>
                      </div>
                    {% endif %}
                  {% endif %}
                  
                  <span class="reading-date">
                    <i class="fas fa-calendar"></i> {{ latest_page.date | date(format="%B %d, %Y") }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
{% endblock content %} 