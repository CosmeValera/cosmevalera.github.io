{% extends "base.html" %}

{% block title %}
  {{ taxonomy.name | title }} | Cosme
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{{ get_url(path="readings-list.css") | safe }}">
{% endblock %}

{% block content %}
  <div class="readings-list">
    <a href="/readings" class="back-link">← Back to all readings</a>
    <h1 class="readings-list-title">{{ taxonomy.name | title }} Books</h1>
    <p class="readings-description">Books in the {{ taxonomy.name | title }} category.</p>
    
    <div class="readings-grid">
      {% for term in terms %}
        {% for page in term.pages %}
          <div class="reading-card{% if page.extra.has_single_page is defined and page.extra.has_single_page == true %}" onclick="window.location='{{ page.permalink }}';{% endif %}">
            {% if page.extra and page.extra.cover_image %}
              <div class="reading-card-cover">
                <img src="{{ page.extra.cover_image }}" alt="Cover of {{ page.title }}">
              </div>
            {% endif %}
            
            <!-- Always visible indicators -->
            <div class="card-indicators">
              {% if page.extra and page.extra.has_single_page is defined and page.extra.has_single_page == true %}
                <div class="review-badge">
                  <i class="fas fa-star"></i>
                  <span>Review</span>
                </div>
              {% endif %}
              <div class="reading-date-top">
                <i class="fas fa-calendar"></i> {{ page.date | date(format="%B %d, %Y") }}
              </div>
            </div>
            
            <div class="reading-card-overlay">
              <!-- Interactive Navigation for All Books -->
              <div class="reading-card-navigation">
                <!-- Content Area -->
                <div class="content-area">
                  <!-- Description Content (Always Visible) -->
                  <div class="content-section active" id="description">
                    <h3 class="reading-title">
                      {{ page.title }}
                    </h3>
                    
                    {% if page.extra and page.extra.author %}
                      <p class="reading-author">by {{ page.extra.author }}</p>
                    {% endif %}
                    
                    {% if page.description %}
                      <p class="reading-description">{{ page.description }}</p>
                    {% endif %}
                    
                    {% if page.extra and page.extra.rating %}
                      <div class="reading-rating">
                        {% for i in range(end=page.extra.rating) %}
                          <span class="star">⭐</span>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                  
                  <!-- Key Insights Content -->
                  {% if page.extra.key_insights %}
                  <div class="content-section" id="insights">
                    <div class="reading-insights">
                      <h4>Key Insights</h4>
                      <ul>
                        {% for insight in page.extra.key_insights %}
                          <li>{{ insight }}</li>
                        {% endfor %}
                      </ul>
                    </div>
                  </div>
                  {% endif %}
                  
                  <!-- Personal Note Content -->
                  {% if page.extra.personal_note %}
                  <div class="content-section" id="personal">
                    <div class="reading-personal-note">
                      <h4>Personal Reflection</h4>
                      <p>{{ page.extra.personal_note }}</p>
                    </div>
                  </div>
                  {% endif %}
                </div>
                
                <!-- Bottom Navigation -->
                <div class="bottom-navigation">
                  <div class="nav-squares">
                    <div class="nav-square active" data-content="description">
                      <i class="fas fa-info-circle"></i>
                    </div>
                    {% if page.extra.key_insights %}
                    <div class="nav-square" data-content="insights">
                      <i class="fas fa-lightbulb"></i>
                    </div>
                    {% endif %}
                    {% if page.extra.personal_note %}
                    <div class="nav-square" data-content="personal">
                      <i class="fas fa-heart"></i>
                    </div>
                    {% endif %}
                  </div>
                  
                  <div class="bottom-right-content">
                    {% if page.taxonomies and page.taxonomies.categories %}
                      <div class="reading-categories">
                        {% for category in page.taxonomies.categories %}
                          <span class="reading-category">{{ category | slugify | replace(from="-", to=" ") | title }}</span>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      {% endfor %}
    </div>
  </div>
{% endblock content %}

{% block scripts %}
<script src="{{ get_url(path="js/readings.js") | safe }}"></script>
{% endblock %}
